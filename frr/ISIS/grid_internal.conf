!
! FRR Configuration - Grid内部路由器 (L1)
! 示例: Grid-A R5 (中心节点)
! 追求快速收敛，启用IETF SPF优化
!
frr version 10.0
frr defaults traditional
!
hostname GridA-R5-Internal
!
! 基础接口配置
interface lo
 ip address 10.1.0.5/32
 ipv6 address 2001:db8:1::5/128
 ip router isis 1
 ipv6 router isis 1
 isis passive
!
! Grid内连接 - 全部L1级别
interface eth0
 description "To GridA-R2 (L1L2 boundary)"
 ip address 10.1.10.5/30
 ipv6 address 2001:db8:1:10::5/64
 ip router isis 1
 ipv6 router isis 1
 isis circuit-type level-1
 isis network point-to-point
 isis hello-interval 1
 isis hello-multiplier 3
 isis csnp-interval 2
 isis psnp-interval 1
 isis metric 10
!
interface eth1
 description "To GridA-R4 (L1L2 boundary)"
 ip address 10.1.11.5/30
 ipv6 address 2001:db8:1:11::5/64
 ip router isis 1
 ipv6 router isis 1
 isis circuit-type level-1
 isis network point-to-point
 isis hello-interval 1
 isis hello-multiplier 3
 isis csnp-interval 2
 isis psnp-interval 1
 isis metric 10
!
interface eth2
 description "To GridA-R6 (L1L2 boundary)"
 ip address 10.1.12.5/30
 ipv6 address 2001:db8:1:12::5/64
 ip router isis 1
 ipv6 router isis 1
 isis circuit-type level-1
 isis network point-to-point
 isis hello-interval 1
 isis hello-multiplier 3
 isis csnp-interval 2
 isis psnp-interval 1
 isis metric 10
!
interface eth3
 description "To GridA-R8 (L1L2 boundary)"
 ip address 10.1.13.5/30
 ipv6 address 2001:db8:1:13::5/64
 ip router isis 1
 ipv6 router isis 1
 isis circuit-type level-1
 isis network point-to-point
 isis hello-interval 1
 isis hello-multiplier 3
 isis csnp-interval 2
 isis psnp-interval 1
 isis metric 10
!
! 可选：连接其他内部节点
interface eth4
 description "To GridA-R1 (L1 internal)"
 ip address 10.1.14.5/30
 ipv6 address 2001:db8:1:14::5/64
 ip router isis 1
 ipv6 router isis 1
 isis circuit-type level-1
 isis network point-to-point
 isis hello-interval 1
 isis hello-multiplier 3
 isis csnp-interval 2
 isis psnp-interval 1
 isis metric 10
!
! ISIS主配置
router isis 1
 net 49.0001.0000.0000.0005.00
 is-type level-1
 metric-style wide
 
 ! 快速收敛优化
 lsp-gen-interval 1
 lsp-refresh-interval 600
 max-lsp-lifetime 1200
 spf-interval 1 5 50
 spf-delay-ietf init-delay 50 short-delay 50 long-delay 200 holddown 2000 time-to-learn 500
 
 ! 路由重分发 (仅L1级别)
 redistribute ipv4 connected level-1 metric 10
 redistribute ipv6 connected level-1 metric 10
 
 ! ECMP支持
 maximum-paths 4
 
 ! 快速Hello和邻接检测
 hello-padding
 
 ! LSP数据库优化
 lsp-mtu 1492
 
 ! ATT位处理 (默认启用，可显式配置)
 no attached-bit receive ignore
!
! BFD配置 (可选，进一步加速故障检测)
bfd
 peer 10.1.10.2 interface eth0
  detect-multiplier 3
  receive-interval 300
  transmit-interval 300
 !
 peer 10.1.11.4 interface eth1
  detect-multiplier 3
  receive-interval 300
  transmit-interval 300
 !
 peer 10.1.12.6 interface eth2
  detect-multiplier 3
  receive-interval 300
  transmit-interval 300
 !
 peer 10.1.13.8 interface eth3
  detect-multiplier 3
  receive-interval 300
  transmit-interval 300
 !
!
! 接口BFD启用
interface eth0
 ip ospf bfd
 ipv6 ospf6 bfd
!
interface eth1
 ip ospf bfd
 ipv6 ospf6 bfd
!
interface eth2
 ip ospf bfd
 ipv6 ospf6 bfd
!
interface eth3
 ip ospf bfd
 ipv6 ospf6 bfd
!
! 日志配置
log syslog informational
log facility local4
!
! 调试配置 (生产环境建议关闭)
! debug isis events
! debug isis route-events
! debug isis spf-events
! debug isis adj-packets
!
line vty
!
end
